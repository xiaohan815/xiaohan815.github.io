(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3500"],{"5bda":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"execution"},[a("basic-container",[a("avue-crud",{ref:"crud",attrs:{page:e.page,data:e.tableData,permission:e.permissionList,"table-loading":e.tableLoading,option:e.tableOption},on:{"on-load":e.getList,"refresh-change":e.refreshChange,"search-change":e.searchChange,"size-change":e.sizeChange,"current-change":e.currentChange,"row-save":e.handleSave,"row-del":e.rowDel},scopedSlots:e._u([{key:"menu",fn:function(t){return[e.permissionList.addBtn?a("el-button",{attrs:{type:"text",icon:"el-icon-check"},on:{click:function(a){return e.reply(t.row,t.index)}}},[e._v("回复\n        ")]):e._e()]}}])}),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogFormVisible,title:"回复消息"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("avue-crud",{ref:"crudLog",attrs:{page:e.pageRes,data:e.tableResData,option:e.tableResOption},on:{"row-save":e.handleResSave,"row-del":e.rowResDel}})],1)],1)],1)},n=[],i=a("5530"),r=a("b775");function o(e){return Object(r["default"])({url:"/mp/wxfansmsg/page",method:"get",params:e})}function c(e){return Object(r["default"])({url:"/mp/wxfansmsg",method:"post",data:e})}function l(e){return Object(r["default"])({url:"/mp/wxfansmsg/"+e,method:"delete"})}function d(e){return Object(r["default"])({url:"/mp/wxfansmsgres/page",method:"get",params:e})}function p(e){return Object(r["default"])({url:"/mp/wxfansmsgres",method:"post",data:e})}function g(e){return Object(r["default"])({url:"/mp/wxfansmsgres/"+e,method:"delete"})}var u={border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",viewBtn:!0,addBtn:!1,editBtn:!1,searchMenuSpan:6,align:"center",column:[{label:"主键",prop:"id",hide:!1},{label:"公众号",prop:"wxAccountName"},{label:"用户标识",prop:"openid",overHidden:!0},{label:"昵称",prop:"nickname"},{label:"消息类型",prop:"msgType"},{label:"内容",prop:"content"},{label:"已回复",prop:"isRes",type:"select",dicUrl:"/admin/dict/type/response_type",search:!0},{label:"创建时间",prop:"createTime"},{label:"头像地址",prop:"headimgUrl",type:"upload",imgWidth:60,imgFullscreen:!0,editDisplay:!1,addDisplay:!1,listType:"picture-img"}]},h={border:!0,index:!0,indexLabel:"序号",stripe:!0,viewBtn:!0,editBtn:!1,delBtn:!0,menuAlign:"center",align:"center",column:[{label:"回复人",prop:"userName",addDisplay:!1},{label:"回复内容",prop:"resContent",type:"textarea",span:24,minRows:5},{label:"时间",prop:"createTime",addDisplay:!1}]},m=a("2f62"),f={name:"Wxfansmsg",data:function(){return{searchForm:{},dialogFormVisible:!1,tableData:[],tableResData:[],page:{total:0,currentPage:1,pageSize:20},pageRes:{total:0,currentPage:1,pageSize:20},tableLoading:!1,tableOption:u,tableResOption:h,msgId:void 0}},computed:Object(i["a"])(Object(i["a"])({},Object(m["mapGetters"])(["permissions"])),{},{permissionList:function(){return{addBtn:this.vaildData(this.permissions.mp_wxfansmsg_add,!1),delBtn:this.vaildData(this.permissions.mp_wxfansmsg_del,!1),editBtn:this.vaildData(this.permissions.mp_wxfansmsg_edit,!1)}}}),methods:{getList:function(e,t){var a=this;this.tableLoading=!0,o(Object.assign({current:e.currentPage,size:e.pageSize},t,this.searchForm)).then((function(e){a.tableData=e.data.data.records,a.page.total=e.data.data.total,a.tableLoading=!1}))},getResList:function(e,t){var a=this;d(Object.assign({current:e.currentPage,size:e.pageSize},t)).then((function(e){a.tableResData=e.data.data.records,a.pageRes.total=e.data.data.total}))},rowDel:function(e,t){var a=this,s=this;this.$confirm("是否确认删除ID为"+e.id,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return l(e.id)})).then((function(){s.tableData.splice(t,1),s.$message({showClose:!0,message:"删除成功",type:"success"}),a.getList(a.page)})).catch((function(){}))},handleSave:function(e,t){var a=this;c(e).then((function(){a.tableResData.push(Object.assign({},e)),a.$message({showClose:!0,message:"添加成功",type:"success"}),t(),a.getList(a.page)}))},rowResDel:function(e){var t=this,a=this;this.$confirm("是否确认删除ID为"+e.id,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return g(e.id)})).then((function(){a.$message({showClose:!0,message:"删除成功",type:"success"}),t.getResList(t.pageRes,{fansMsgId:t.msgId})})).catch((function(){}))},handleResSave:function(e,t){var a=this;e.fansMsgId=this.msgId,p(e).then((function(){a.$message({showClose:!0,message:"发送成功",type:"success"}),t(),a.getResList(a.pageRes,{fansMsgId:a.msgId})}))},sizeChange:function(e){this.page.pageSize=e},currentChange:function(e){this.page.currentPage=e},refreshChange:function(){this.getList(this.page)},searchChange:function(e,t){this.searchForm=e,this.getList(this.page,e),t()},reply:function(e){this.msgId=e.id,this.dialogFormVisible=!0,this.getResList(this.pageRes,{fansMsgId:this.msgId}),this.getList(this.page)}}},b=f,w=a("2877"),v=Object(w["a"])(b,s,n,!1,null,"ee6e6c18",null);t["default"]=v.exports}}]);