(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b5dad8c2"],{"833c":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.infoOption=a.tableOption=void 0;var n={dialogWidth:"100%",dialogFullscreen:!0,border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",align:"center",searchMenuSpan:6,column:[{type:"input",label:"api名称",search:!0,prop:"apiName"},{type:"select",search:!0,label:"微服务",dicUrl:"/admin/dict/type/api_service_name",prop:"apiService"},{type:"select",label:"是否分页",dicData:[{label:"是",value:"0"},{label:"否",value:"1"}],rules:[{required:!0,message:"请选择是否分页"}],prop:"pageOn"},{type:"input",label:"api路径",search:!0,rules:[{required:!0,message:"请输入api路径"}],prop:"apiPath"},{type:"select",label:"请求方式",dicData:[{label:"get",value:"1"},{label:"post",value:"2"}],rules:[{required:!0,message:"请选择请求方式"}],prop:"apiMethod"},{type:"select",label:"暴露选项",prop:"exposeType",dicData:[{label:"需要登录",value:"1"},{label:"微服务间无需登录",value:"2"},{label:"无需登录",value:"3"}],rules:[{required:!0,message:"请选择暴露选项"}],display:!0},{type:"radio",label:"上线标记",prop:"isOnline",dicData:[{label:"上线",value:"0"},{label:"下线",value:"1"}],display:!1,value:"0"},{type:"datetime",label:"创建时间",prop:"createTime",readonly:!0,display:!1,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{type:"datetime",readonly:!0,label:"更新时间",prop:"updateTime",display:!1,format:"yyyy-MM-dd HH:mm:ss",valueFormat:"yyyy-MM-dd HH:mm:ss"},{type:"textarea",label:"sql语句",prop:"apiSql",overHidden:!0,span:24},{labelWidth:0,label:"",prop:"info",span:24,hide:!0,formslot:!0}]};a.tableOption=n;var i={column:[{label:"参数名",prop:"paramName"},{label:"参数类型",type:"select",dicData:[{label:"String",value:"String"},{label:"Long",value:"Long"},{label:"Integer",value:"Integer"},{label:"Double",value:"Double"},{label:"Date",value:"Date"}],prop:"paramType"}]};a.infoOption=i},c888:function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"execution"},[t("basic-container",[t("avue-crud",{ref:"crud",attrs:{page:e.page,data:e.tableData,permission:e.permissionList,"table-loading":e.tableLoading,option:e.tableOption},on:{"on-load":e.getList,"search-change":e.searchChange,"refresh-change":e.refreshChange,"size-change":e.sizeChange,"current-change":e.currentChange,"row-update":e.handleUpdate,"row-save":e.handleSave,"row-del":e.rowDel},scopedSlots:e._u([{key:"menu",fn:function(a){return[e.outLineOrininePerm&&0!=a.row.isOnline?t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return t.stopPropagation(),e.onLineOrOutLine(a.row)}}},[e._v("上线")]):e.outLineOrininePerm&&1!=a.row.isOnline?t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return t.stopPropagation(),e.onLineOrOutLine(a.row)}}},[e._v("下线")]):e._e()]}},{key:"infoForm",fn:function(a){return[t("avue-crud",{attrs:{option:e.infoOption,data:e.infoData},on:{"row-save":e.handleSaveParams,"row-update":e.handleUpdateParams,"row-del":e.rowDelParams}})]}}]),model:{value:e.tableForm,callback:function(a){e.tableForm=a},expression:"tableForm"}})],1)],1)},i=[],s=t("5530"),r=t("b775");function l(e){return Object(r["default"])({url:"/admin/manageapi/page",method:"get",params:e})}function o(e){return Object(r["default"])({url:"/admin/manageapi",method:"post",data:e})}function c(e){return Object(r["default"])({url:"/admin/manageapi/"+e,method:"delete"})}function p(e){return Object(r["default"])({url:"/admin/manageapi",method:"put",data:e})}var u=t("833c"),d=t("2f62"),m={name:"Manageapi",data:function(){return{tableForm:{},searchForm:{},tableData:[],page:{total:0,currentPage:1,pageSize:20},tableLoading:!1,tableOption:u["tableOption"],infoOption:u["infoOption"]}},computed:Object(s["a"])(Object(s["a"])({},Object(d["mapGetters"])(["permissions"])),{},{permissionList:function(){return this.outLineOrininePerm=this.vaildData(this.permissions.finance_manageapi_edit,!1),{addBtn:this.vaildData(this.permissions.finance_manageapi_add,!1),delBtn:this.vaildData(this.permissions.finance_manageapi_del,!1),editBtn:this.vaildData(this.permissions.finance_manageapi_edit,!1)}},infoData:function(){this.tableForm.sqlParamsObj=[];try{console.log("this.tableForm.params:"+this.tableForm.sqlParams),this.tableForm.sqlParamsObj=this.tableForm.sqlParams?JSON.parse(this.tableForm.sqlParams):[]}catch(e){}return this.tableForm.sqlParamsObj}}),methods:{getList:function(e,a){var t=this;this.tableLoading=!0,l(Object.assign({current:e.currentPage,size:e.pageSize},a,this.searchForm)).then((function(e){t.tableData=e.data.records,t.page.total=e.data.total,t.tableLoading=!1})).catch((function(){t.tableLoading=!1}))},rowDel:function(e,a){var t=this;this.$confirm("是否确认删除ID为"+e.apiId,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return c(e.apiId)})).then((function(e){t.$message.success("删除成功"),t.getList(t.page)}))},handleUpdate:function(e,a,t,n){var i=this;console.log(e),e.sqlParams=JSON.stringify(this.tableForm.sqlParamsObj),console.log(e),p(e).then((function(e){i.$message.success("修改成功"),t(),i.getList(i.page)})).catch((function(){n()}))},handleSave:function(e,a,t){var n=this;console.log("before:"+e),e.sqlParams=JSON.stringify(this.tableForm.sqlParamsObj),console.log("after:"+e),o(e).then((function(e){n.$message.success("添加成功"),a(),n.getList(n.page)})).catch((function(){t()}))},handleSaveParams:function(e,a,t){console.log("row:"+e),this.tableForm.sqlParamsObj.push(e),a()},handleUpdateParams:function(e,a,t,n){console.log("row:"+e+"==>index:"+a),this.tableForm.sqlParamsObj.splice(a,1,e),t()},rowDelParams:function(e,a){console.log("删除的row:"+e+"==>index:"+a),this.tableForm.sqlParamsObj.splice(a,1)},sizeChange:function(e){this.page.pageSize=e},currentChange:function(e){this.page.currentPage=e},searchChange:function(e,a){this.searchForm=e,this.getList(this.page,e),a()},refreshChange:function(){this.getList(this.page)},onLineOrOutLine:function(e){var a=this;if("0"==e.isOnline){var t=JSON.parse(JSON.stringify(e));this.$set(t,"isOnline","1"),p(t).then((function(e){a.$message.success("下线成功"),a.getList(a.page)})).catch((function(){a.$message.error("下线失败")}))}else if("1"==e.isOnline){var n=JSON.parse(JSON.stringify(e));this.$set(n,"isOnline","0"),p(n).then((function(e){a.$message.success("上线成功"),a.getList(a.page)})).catch((function(){a.$message.error("上线失败")}))}}}},h=m,g=t("2877"),b=Object(g["a"])(h,n,i,!1,null,null,null);a["default"]=b.exports}}]);