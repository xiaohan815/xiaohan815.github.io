(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d6001"],{"714e":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"execution"},[n("basic-container",[n("avue-crud",{ref:"crud",attrs:{page:e.page,data:e.tableData,"table-loading":e.tableLoading,option:e.tableOption},on:{"on-load":e.getList,"search-change":e.searchChange,"refresh-change":e.refreshChange,"row-del":e.rowDel},scopedSlots:e._u([{key:"menuBtn",fn:function(t){return[e.permissions.act_process_manage?n("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(n){return e.handleXML(t.row,t.index)}}},[e._v("流程XML\n        ")]):e._e(),e._v(" "),e.permissions.act_process_manage?n("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(n){return e.handlePic(t.row,t.index)}}},[e._v("流程图\n        ")]):e._e(),e._v(" "),e.permissions.act_process_manage&&t.row.suspend?n("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(n){return e.handleStatus(t.row,"active")}}},[e._v("激活\n        ")]):e._e(),e._v(" "),e.permissions.act_process_manage&&!t.row.suspend?n("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(n){return e.handleStatus(t.row,"suspend")}}},[e._v("失效\n        ")]):e._e(),e._v(" "),e.permissions.act_process_manage?n("el-dropdown-item",{attrs:{divided:""},nativeOn:{click:function(n){return e.handleDel(t.row,"suspend")}}},[e._v("删除\n        ")]):e._e()]}}])}),e._v(" "),n("el-divider"),e._v(" "),e.permissions.act_process_manage?n("el-upload",{attrs:{drag:"",action:"/act/processDef/deploy",headers:e.myheaders,"on-success":e.refreshSelectedTag,multiple:""}},[n("i",{staticClass:"el-icon-upload"}),e._v(" "),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击上传")])]),e._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("部署流程资源")])]):e._e()],1),e._v(" "),n("el-dialog",{attrs:{visible:e.showPicDialog,title:"流程图"},on:{"update:visible":function(t){e.showPicDialog=t}}},[n("img",{attrs:{src:e.actPicUrl,width:"100%"}})]),e._v(" "),n("a",{staticStyle:{display:"none"},attrs:{id:"downloadA",target:"_blank"}})],1)},i=[],s=(n("a481"),n("5530")),o=n("b775");function r(e){return Object(o["default"])({url:"/act/processDef/list",method:"get",params:e})}function c(e){return Object(o["default"])({url:"/act/processDef/"+e,method:"delete"})}function d(e,t){return Object(o["default"])({url:"/act/processDef/status/"+e+"/"+t,method:"put"})}var l={border:!0,index:!0,indexLabel:"序号",stripe:!0,menuAlign:"center",menuWidth:150,menuBtn:!0,align:"center",addBtn:!1,editBtn:!1,delBtn:!1,menuType:"menu",searchMenuSpan:9,searchLabelWidth:150,column:[{fixed:!0,label:"流程定义ID",prop:"processonDefinitionId"},{fixed:!0,label:"部署ID",prop:"deploymentId",editDisabled:!0},{label:"流程定义名称",prop:"name",search:!0},{label:"流程定义KEY",prop:"key"},{label:"版本号",prop:"revision",editDisabled:!0,addDisplay:!1},{label:"是否激活",prop:"isActive",editDisabled:!0,addDisplay:!1},{label:"部署时间",prop:"deploymentTime",type:"datetime",format:"yyyy-MM-dd HH:mm",valueFormat:"timestamp",editDisabled:!0,addDisplay:!1}]},u=n("2f62"),p=n("5f87"),m={name:"Process",data:function(){return{myheaders:{Authorization:"Bearer "+Object(p["a"])()},searchForm:{},showPicDialog:!1,actPicUrl:"",tableData:[],page:{total:0,currentPage:1,pageSize:20},tableLoading:!1,tableOption:l}},created:function(){},mounted:function(){},computed:Object(s["a"])({},Object(u["mapGetters"])(["permissions"])),methods:{getList:function(e,t){var n=this;this.tableLoading=!0,r(Object.assign({descs:"create_time",current:e.currentPage,size:e.pageSize},t,this.searchForm)).then((function(e){n.tableData=e.data.records,n.page.total=e.data.total,n.tableLoading=!1})).catch((function(){n.tableLoading=!1}))},refreshSelectedTag:function(){var e=this;this.$store.dispatch("tagsView/delCachedView",this.$route).then((function(){var t=e.$route.fullPath;e.$nextTick((function(){e.$router.replace({path:"/redirect"+t})}))}))},handleXML:function(e){document.getElementById("downloadA").href="/act/processDef/resource?pdid="+e.processonDefinitionId+"&&resourceName="+e.xmlName,document.getElementById("downloadA").click()},handlePic:function(e){document.getElementById("downloadA").href="/act/processDef/resource?pdid="+e.processonDefinitionId+"&&resourceName="+e.picName,document.getElementById("downloadA").click()},handleStatus:function(e,t){var n=this;this.$confirm('是否确认操作ID为"'+e.processonDefinitionId+'"的流程?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return d(e.processonDefinitionId,t)})).then((function(){n.$message.success("操作成功"),n.getList(n.page)}))},handleDel:function(e,t){this.$refs.crud.rowDel(e,t)},rowDel:function(e){var t=this;this.$confirm('是否确认删除ID为"'+e.deploymentId+'"的模型?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return c(e.deploymentId)})).then((function(){t.$message.success("删除成功"),t.getList(t.page)}))},searchChange:function(e,t){this.searchForm=e,this.getList(this.page,e),t()},refreshChange:function(){this.getList(this.page)}}},h=m,f=n("2877"),g=Object(f["a"])(h,a,i,!1,null,"da9b9d52",null);t["default"]=g.exports}}]);